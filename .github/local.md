# ローカルでの編集
## Gitのインストール
このホームページはGitにより管理されています. 編集を行うにはGitの環境構築が必要です.
まずは[こちら](https://git-scm.com/downloads)からGitをダウンロードし, インストールしてください. 基本的にはデフォルトの設定で問題ありません.  
インストールが完了したら, PowerShell等のターミナルを開き, 以下のコマンドを実行してください.  
```powershell
git --version
```
バージョンが表示されればインストール成功です. エラーが出る場合は正常にインストールされていません. 再度インストールを行ってください.

## Gitの初期設定
Gitのインストールが完了したら, [こちら](https://git-scm.com/book/ja/v2/%E4%BD%BF%E3%81%84%E5%A7%8B%E3%82%81%E3%82%8B-%E6%9C%80%E5%88%9D%E3%81%AEGit%E3%81%AE%E6%A7%8B%E6%88%90) の手順に従い, Gitの初期設定を行います.  
以下のコマンドを実行してください.`Your_Name`と`Your_Email_Address`は自分の名前とメールアドレスに置き換えます.
```powershell
git config --global user.name "Your_Name"
git config --global user.email Your_Email_Address
```
最後に, `git config --list`を実行し, `user.name`と`user.email`が正しく設定されていることを確認してください.

## リポジトリのクローン
編集を行うには, まずこのリポジトリを自分のPCにクローン(ダウンロード)する必要があります.  
`cd`コマンドで任意のディレクトリに移動してから`git clone`コマンドを実行し, リポジトリをクローンしてください.
```powershell
cd 任意のディレクトリ
git clone https://github.com/TechnoTUT/technotut.net.git
```
クローンが完了すると、`technotut.net`というディレクトリが作成され, その中にリポジトリのファイルがダウンロードされます. `cd technotut.net`を実行して, ディレクトリに移動します.

## nodeのインストール
このホームページはNext.jsで作成されています. Next.jsはnode.jsというプラットフォーム上で動作するため, node.jsのインストールが必要です.  
[こちら](https://nodejs.org/ja/)からnode.jsをダウンロードし, インストールします.

## パッケージのインストール
`technotut.net`ディレクトリに移動したら, 以下のコマンドを実行してパッケージをインストールします.
```powershell
npm install
```
少し待つと, パッケージのインストールが完了します.

## 開発サーバの起動
ここで, 開発サーバを起動してみましょう. 以下のコマンドを実行してください.
```powershell
npm run dev
```
少し待ってから, ブラウザを開いて`http://localhost:3000`にアクセスすると, ホームページが表示されます.  
停止する場合は, ターミナル(PowerShellなど)に戻り, `Ctrl + C`を押して開発サーバを停止します.  

## 編集
### ブランチを切る
とりあえず, `git branch`を実行してみましょう. 以下のような出力が得られるはずです.
```powershell
* main
```
`*`がついているブランチが現在のブランチです. この場合, `main`ブランチが現在のブランチです.
編集を行うにあたって, 新たにブランチを作成して作業を行います. これは, 本番環境であるmainブランチに直接編集を加えると, 誤った編集をしてしまったときに本番環境に影響を与えてしまうためです. よって, 編集時にはブランチを切ってコピーを作成し, そのコピーに編集を行います.  
以下のコマンドを実行して, ブランチを切ってください. `branch_name`は任意の名前に置き換えます.
```powershell
git branch branch_name
```
ここで, 再度`git branch`を実行すると, 以下のような出力が得られます.
```powershell
* main
  branch_name
```
`branch_name` というブランチが作成されました.  
次に, 以下のコマンドを実行して, 作成したブランチに移動しましょう.
```powershell
git checkout branch_name
```
再度`git branch`を実行すると, 以下のような出力が得られます.
```powershell
  main
* branch_name
```
`branch_name`ブランチに切り替わりました. これで, ファイルに変更を加えても, 本番環境に影響を与えることはありません.  

### 編集
では, 実際に編集を行ってみましょう.  
`npm run dev`を実行して, 開発サーバを起動し, ブラウザで`http://localhost:3000`にアクセスします.  
VSCodeやVimなどのエディタを開き, `/content`ディレクトリ内を編集します. `/content/news`ディレクトリを編集すると, https://technotut.net/news に記事を追加したり, 編集したりすることができます.  
`/content`ディレクトリには, ホームページのコンテンツが格納されています.　Markdown形式で記述されており, 簡単に編集できます.  
また, 画像などは画像URLをMarkdownファイルに記述することで, Web上の画像をそのまま貼り付けることもできますが, 画像をアップロードすることもできます. 画像をアップロードする場合は, `/public`ディレクトリに画像を追加し, 画像のパスをMarkdownファイルに記述します.なお, パスは`/public`ディレクトリからの相対パスで記述します.

### 編集の確認
編集して保存すると, 開発サーバに自動的に反映されます. ブラウザを更新すると, 編集した内容が反映されているはずです.  

### コミット
編集が完了したら, 以下のコマンドを実行してコミットします. `commit_message`は任意のメッセージに置き換えます.
```powershell
git add .
git commit -m "commit_message"
```
以上でコミットが完了しました.  
コマンドの意味は以下の通りです.
- `git add .`  
  編集したファイルをコミットするために, ステージングエリアに追加します.  
    ステージングエリアとは, コミットするファイルを一時的に格納する場所です. ここに追加されたファイルは, 一時的に格納されるため, まだコミットされていないという状態になります. `.`は, 現在のディレクトリ以下のファイルをすべてステージングエリアに追加するという意味です.  
    `git status`コマンドで, ステージングエリアに追加されたファイルを確認することができます.
    なお, `git add`コマンドで間違えてファイルを追加してしまった場合は, `git reset`コマンドでステージングエリアからファイルを削除することができます.
- `git commit -m "commit_message"`
    ステージングエリアに追加されたファイルをコミットします. `commit_message`はコミットメッセージです. コミットメッセージは, そのコミットで行った変更を簡潔に表すものです.  

ここで, `git log`を実行してみましょう. 先ほどコミットした内容が表示されているはずです. また, `git log --graph`を実行すると, コミットの履歴がグラフで表示されます.  

### プッシュ
コミットが完了したら, 以下のコマンドを実行してGitHubにプッシュします.
```powershell
git push origin branch_name
```
https://github.com/technotut/technotut.net/tree/branch_name にアクセスすると, プッシュしたブランチが作成されているはずです.  
正常にプッシュできていれば, 編集した内容が反映されているはずです.  
また, https://github.com/TechnoTUT/technotut.net/actions にアクセスすると, GitHub Actionsによって自動的にビルドが行われ, 作成されたプレビューを見ることができます. 

### プルリクエスト
編集した内容を本番環境`main`ブランチにマージするために, プルリクエストを作成します.  
https://github.com/technotut.net/ にアクセスし, `Compare & pull request`ボタンをクリックします. どういった変更を行ったかを記述し, `Create pull request`ボタンをクリックします.  

## お疲れさまでした
プルリクエストが作成されたら, 管理者によってレビューが行われます. 問題がなければ, プルリクエストがマージされ, 編集した内容が本番環境に反映されます. 